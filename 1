---

- name: onyx_config_main
  hosts: ONYX 
  gather_facts: no
  connection: network_cli
  become: yes
  become_method: enable
  vars:
    ansible_network_os: onyx
    path: "" 
    type: "text"
    del_all_first: "no"
    transfer_protocol: scp
  remote_user: admin

  tasks:
    
    - name: delete all config in the first place
      when: del_all_first == "yes"
      onyx_config:
         lines:
          - configuration new play_factory factory keep-connect
          - configuration switch-to play_factory_1
#      expect:
#        command: configuration switch-to play_factory_1
#        responses:
#            'Type to confirm:': 'yes'
    

    - name: apply text configuration file 
      when: type == "text"
      onyx_config:
          src:  "{{ path }}"

    - name: apply binary configuration file
      when: type == "bin"
      onyx_config:
          src:  "{{ path }}"
